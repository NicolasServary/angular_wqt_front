<div class="dashboard-interface">
    <!-- Dashboard Header -->
    <div class="dashboard-header">
      <div class="header-text">
        <h1 class="dashboard-title">Votre centre de pilotage</h1>
        <p class="dashboard-subtitle">Explorez les données collectées dans votre magasin en temps réel</p>
      </div>
      <div class="header-actions">
        <div class="affluence-controls">
          <button class="period-btn" [class.active]="selectedPeriod === 'day'" (click)="setPeriod('day')">Jour</button>
          <button class="period-btn" [class.active]="selectedPeriod === 'week'" (click)="setPeriod('week')">Semaine</button>
          <button class="period-btn" [class.active]="selectedPeriod === 'month'" (click)="setPeriod('month')">Mois</button>
          <button class="period-btn" [class.active]="selectedPeriod === 'year'" (click)="setPeriod('year')">Année</button>
          <input type="date" class="date-picker" (change)="onDateChange($event)">
        </div>
        <button class="download-btn" (click)="downloadData()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          <span>Télécharger</span>
        </button>
      </div>
    </div>

    <!-- Key Metrics Section -->
    <div class="metrics-section">
      <div class="metrics-grid">
        <div class="metric-card">
          <div class="metric-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
          </div>
          <div class="metric-content">
            <div class="metric-label">Longueur moyenne des files d'attente</div>
            <div class="metric-number">{{ metrics.avgQueueLength }}</div>
            <div class="metric-info">
              <span class="metric-detail">{{ metrics.avgQueueLengthDetail }}</span>
              <span class="metric-trend" [ngClass]="{
                'metric-trend-down': metrics.avgQueueLengthTrend > 0,
                'metric-trend-up': metrics.avgQueueLengthTrend < 0,
                'metric-trend-neutral': metrics.avgQueueLengthTrend === 0
              }">{{ metrics.avgQueueLengthTrendText }}</span>
            </div>
          </div>
        </div>

        <div class="metric-card">
          <div class="metric-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
          </div>
          <div class="metric-content">
            <div class="metric-label">Pic d'affluence de la période</div>
            <div class="metric-number">{{ metrics.peakCrowd }}</div>
            <div class="metric-info">
              <span class="metric-detail">{{ metrics.peakCrowdDetail }}</span>
              <span class="metric-trend" [ngClass]="{
                'metric-trend-down': metrics.peakCrowdTrend > 0,
                'metric-trend-up': metrics.peakCrowdTrend < 0,
                'metric-trend-neutral': metrics.peakCrowdTrend === 0
              }">{{ metrics.peakCrowdTrendText }}</span>
            </div>
          </div>
        </div>

        <div class="metric-card">
          <div class="metric-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="8.5" cy="7" r="4"></circle>
              <path d="M20 8v6M23 11h-6"></path>
            </svg>
          </div>
          <div class="metric-content">
            <div class="metric-label">Affluence moyenne de la période</div>
            <div class="metric-number">{{ metrics.avgCrowd }}</div>
            <div class="metric-info">
              <span class="metric-detail">{{ metrics.avgCrowdDetail }}</span>
              <span class="metric-trend" [ngClass]="{
                'metric-trend-down': metrics.avgCrowdTrend < 0,
                'metric-trend-up': metrics.avgCrowdTrend > 0,
                'metric-trend-neutral': metrics.avgCrowdTrend === 0
              }">{{ metrics.avgCrowdTrendText }}</span>
            </div>
          </div>
        </div>

        <div class="metric-card">
          <div class="metric-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="1" x2="12" y2="23"></line>
              <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
          </div>
          <div class="metric-content">
            <div class="metric-label">Caisses les plus sollicitées</div>
            <div class="metric-number">{{ metrics.topCheckouts }}</div>
            <div class="metric-info">
              <span class="metric-detail">{{ metrics.topCheckoutsDetail }}</span>
              <span class="metric-trend metric-trend-neutral">{{ metrics.topCheckoutsTrendText }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Affluence Analysis Section -->
    <div class="affluence-section">
      <div class="affluence-header">
        <div class="affluence-title-wrapper">
          <div class="affluence-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
          </div>
          <h3 class="affluence-title">Analyse de l'affluence</h3>
        </div>
      </div>
      <div class="affluence-chart-container">
        <canvas #affluenceChart class="affluence-chart"></canvas>
      </div>
    </div>
  </div>